<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Samsung HE AI Visibility and Performance Dashboard</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
/* === base/fonts.html === */
@font-face {
    font-family: 'Samsung Sharp Sans';
    src: url('./fonts/SamsungSharpSansBd.woff2') format('woff2'),
         url('./fonts/SamsungSharpSans-Bold.ttf') format('truetype');
    font-weight: 700;
}
@font-face {
    font-family: 'Samsung One';
    src: url('./fonts/SamsungOneLatinWeb-400.woff2') format('woff2'),
         url('./fonts/SamsungOneLatinCompact-400.ttf') format('truetype');
    font-weight: 400;
}
/* === base/tokens.html === */
:root {
    /* Brand */
    --color-primary: #1428A0;
    --color-primary-light: #8091df;

    /* Accent Palette */
    --color-accent-blue: #0277c6;
    --color-accent-cyan: #02b2e4;
    --color-accent-teal: #01c3b0;
    --color-accent-purple: #8091df;
    --color-accent-green: #96d551;
    --color-accent-yellow: #feb447;
    --color-accent-red: #ff4438;

    /* Semantic */
    --color-success: #4caf50;
    --color-error: #f44336;
    --color-neutral: #9e9e9e;

    /* Backgrounds */
    --color-bg-page: #f8f9fa;
    --color-bg-header: #f7f7f7;
    --color-bg-card: #ffffff;
    --color-bg-success: #e8f5e9;
    --color-bg-error: #ffebee;

    /* Text */
    --color-text-primary: #000000;
    --color-text-secondary: #666666;
    --color-text-link: #1428A0;

    /* Borders */
    --color-border: #e0e0e0;
    --color-border-accent: #1428A0;

    /* Competitor brands */
    --color-brand-samsung: #1428A0;
    --color-brand-lg: #A50034;
    --color-brand-sony: #000000;
    --color-brand-tcl: #E31937;
    --color-brand-hisense: #00A0DF;
    --color-brand-xbox: #107C10;
    --color-brand-roku: #6C3C97;

    /* Typography */
    --font-display: 'Samsung Sharp Sans', sans-serif;
    --font-body: 'Samsung One', -apple-system, sans-serif;
    --font-size-xs: 11px;
    --font-size-sm: 12px;
    --font-size-base: 14px;
    --font-size-md: 16px;
    --font-size-lg: 18px;
    --font-size-xl: 24px;
    --font-size-2xl: 28px;
    --font-size-3xl: 32px;
    --font-size-metric: 42px;
    --font-weight-normal: 400;
    --font-weight-medium: 500;
    --font-weight-bold: 700;
    --line-height-tight: 1.1;
    --line-height-normal: 1.5;

    /* Spacing */
    --spacing-xs: 4px;
    --spacing-sm: 8px;
    --spacing-md: 12px;
    --spacing-lg: 16px;
    --spacing-xl: 20px;
    --spacing-2xl: 24px;

    /* Layout */
    --max-width: 1400px;
    --header-logo-height: 36px;

    /* Radius */
    --radius-sm: 4px;
    --radius-md: 6px;
    --radius-lg: 8px;
    --radius-xl: 12px;

    /* Shadows */
    --shadow-sm: 0 2px 4px rgba(0,0,0,0.05);
}

* { box-sizing: border-box; margin: 0; padding: 0; }

body {
    font-family: var(--font-body);
    background: var(--color-bg-page);
    color: var(--color-text-primary);
}

.container {
    max-width: var(--max-width);
    margin: 0 auto;
    padding: var(--spacing-2xl);
}
/* === header.html === */
header {
    background: var(--color-bg-header);
    border-bottom: 3px solid var(--color-border-accent);
    margin-bottom: var(--spacing-2xl);
    box-shadow: var(--shadow-sm);
}

.header-content {
    max-width: var(--max-width);
    margin: 0 auto;
    padding: var(--spacing-lg) var(--spacing-2xl);
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.header-title {
    font-family: var(--font-display);
    font-size: var(--font-size-2xl);
    font-weight: var(--font-weight-bold);
    color: var(--color-primary);
}

.header-logo {
    height: var(--header-logo-height);
}
/* === kpi-cards.html === */
.kpi-row {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: var(--spacing-lg);
    margin-bottom: var(--spacing-2xl);
}

.kpi-card {
    background: var(--color-bg-card);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-xl);
    padding: var(--spacing-xl);
    min-height: 160px;
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
    position: relative;
}

.kpi-tooltip {
    position: absolute;
    top: 12px;
    right: 12px;
    width: 18px;
    height: 18px;
    background: var(--color-accent-purple);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: help;
}

.kpi-tooltip span {
    color: white;
    font-size: 12px;
    font-weight: 700;
    line-height: 1;
}

.kpi-tooltip-text {
    visibility: hidden;
    opacity: 0;
    position: absolute;
    top: 28px;
    right: 0;
    width: 220px;
    background: #333;
    color: white;
    font-family: var(--font-body);
    font-size: 12px;
    font-weight: 400;
    padding: 10px 12px;
    border-radius: 6px;
    line-height: 1.4;
    text-align: left;
    z-index: 100;
    transition: opacity 0.2s, visibility 0.2s;
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
}

.kpi-tooltip-text::before {
    content: '';
    position: absolute;
    top: -6px;
    right: 12px;
    border-left: 6px solid transparent;
    border-right: 6px solid transparent;
    border-bottom: 6px solid #333;
}

.kpi-tooltip:hover .kpi-tooltip-text {
    visibility: visible;
    opacity: 1;
}

.kpi-icon {
    width: 64px;
    height: 64px;
    margin-bottom: var(--spacing-md);
    object-fit: contain;
}

.kpi-label {
    font-family: var(--font-display);
    font-size: var(--font-size-xs);
    text-transform: uppercase;
    color: var(--color-text-secondary);
    letter-spacing: 0.5px;
    font-weight: 700;
    margin-bottom: var(--spacing-xs);
}

.kpi-value {
    font-family: var(--font-display);
    font-size: var(--font-size-metric);
    font-weight: var(--font-weight-bold);
    color: var(--color-primary);
    line-height: var(--line-height-tight);
}

.kpi-change {
    font-size: 13px;
    font-weight: 600;
    margin-top: var(--spacing-xs);
    color: var(--color-text-secondary);
}

.kpi-change.na { color: var(--color-text-secondary); }
.kpi-change.no-change { color: var(--color-accent-yellow); }
.kpi-change.increase { color: var(--color-accent-green); }
.kpi-change.decrease { color: var(--color-accent-red); }
/* === line-charts.html === */
.charts-row {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: var(--spacing-lg);
    margin-bottom: var(--spacing-2xl);
}

.chart-card {
    background: var(--color-bg-card);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-xl);
    padding: var(--spacing-xl);
}

.chart-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: var(--spacing-lg);
}

.chart-title {
    font-family: var(--font-display);
    font-size: 16px;
    font-weight: 700;
    color: #333;
    display: flex;
    align-items: center;
    gap: 6px;
}

.chart-tooltip-icon {
    position: relative;
    width: 18px;
    height: 18px;
    background: var(--color-accent-purple);
    border-radius: 50%;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    cursor: help;
    flex-shrink: 0;
}

.chart-tooltip-icon span {
    color: white;
    font-size: 12px;
    font-weight: 700;
    line-height: 1;
}

.chart-tooltip-text {
    visibility: hidden;
    opacity: 0;
    position: absolute;
    top: 28px;
    left: 0;
    width: 240px;
    background: #333;
    color: white;
    font-family: var(--font-body);
    font-size: 12px;
    font-weight: 400 !important;
    padding: 10px 12px;
    border-radius: 6px;
    line-height: 1.4;
    text-align: left;
    z-index: 100;
    transition: opacity 0.2s, visibility 0.2s;
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
}

.chart-tooltip-text::before {
    content: '';
    position: absolute;
    top: -6px;
    left: 12px;
    border-left: 6px solid transparent;
    border-right: 6px solid transparent;
    border-bottom: 6px solid #333;
}

.chart-tooltip-icon:hover .chart-tooltip-text {
    visibility: visible;
    opacity: 1;
}

.download-btn {
    background: none;
    border: none;
    cursor: pointer;
    padding: 4px;
    color: var(--color-text-secondary);
}

.download-btn:hover {
    color: var(--color-primary);
}

/* Chart + Insights Layout */
.chart-content {
    display: flex;
    gap: 16px;
}

/* D3 Chart Styles */
.chart-area {
    flex: 1;
    min-width: 0;
    height: 280px;
    overflow: hidden;
}

.chart-area svg {
    width: 100%;
    height: 100%;
}

/* Insights Box */
.chart-insights {
    width: 220px;
    flex-shrink: 0;
    background: #f8f9fa;
    border-radius: 8px;
    padding: 16px;
    display: flex;
    flex-direction: column;
    justify-content: center;
}

.insight-item {
    margin-bottom: 12px;
    opacity: 0;
    animation: fadeInUp 0.5s ease forwards;
}

.insight-item:last-child {
    margin-bottom: 0;
}

.insight-item:nth-child(1) { animation-delay: 0.2s; }
.insight-item:nth-child(2) { animation-delay: 0.6s; }
.insight-item:nth-child(3) { animation-delay: 1.0s; }

@keyframes fadeInUp {
    from {
        opacity: 0;
        transform: translateY(10px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.insight-label {
    font-size: 11px;
    color: var(--color-text-secondary);
    text-transform: uppercase;
    letter-spacing: 0.5px;
    margin-bottom: 4px;
}

.insight-value {
    font-family: var(--font-display);
    font-size: 20px;
    font-weight: 700;
    color: var(--color-primary);
}

.insight-value.positive {
    color: var(--color-accent-green);
}

.insight-value.negative {
    color: var(--color-accent-red);
}

.insight-change {
    font-size: 12px;
    color: var(--color-text-secondary);
}

.grid-line {
    stroke: #e8e8e8;
    stroke-width: 1;
}

.axis-line {
    stroke: #ccc;
    stroke-width: 1;
}

.axis text {
    font-family: var(--font-body);
    font-size: 13px;
    fill: var(--color-text-secondary);
}

.axis path,
.axis line {
    stroke: #ccc;
}

.data-line {
    fill: none;
    stroke-width: 2.5;
    stroke-linecap: round;
    stroke-linejoin: round;
}

.data-point {
    stroke-width: 2;
    stroke: white;
}

.chart-legend {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 12px 16px;
    margin-top: 16px;
    padding-top: 12px;
    border-top: 1px solid var(--color-border);
    margin-right: 236px; /* align with chart area (220px insights + 16px gap) */
}

.legend-item {
    display: flex;
    align-items: center;
    gap: 6px;
    font-size: 12px;
    color: var(--color-text-secondary);
}

.legend-dot {
    width: 10px;
    height: 10px;
    border-radius: 50%;
}

/* Tooltip */
.line-chart-tooltip {
    position: absolute;
    background: #333;
    color: white;
    padding: 8px 12px;
    border-radius: 6px;
    font-size: 12px;
    pointer-events: none;
    opacity: 0;
    transition: opacity 0.15s;
    z-index: 100;
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
}

.line-chart-tooltip.visible {
    opacity: 1;
}
/* === platform-tables.html === */
/* Platform Table Card */
.platform-table-card {
    background: var(--color-bg-card);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-xl);
    padding: var(--spacing-xl);
}

.table-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: var(--spacing-lg);
}

.table-title {
    font-family: var(--font-display);
    font-size: 14px;
    font-weight: 700;
    color: #333;
    display: flex;
    align-items: center;
    gap: 6px;
}

.table-tooltip-icon {
    position: relative;
    width: 18px;
    height: 18px;
    background: var(--color-accent-purple);
    border-radius: 50%;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    cursor: help;
    flex-shrink: 0;
}

.table-tooltip-icon span {
    color: white;
    font-size: 12px;
    font-weight: 700;
    line-height: 1;
}

.table-tooltip-text {
    visibility: hidden;
    opacity: 0;
    position: absolute;
    top: 28px;
    left: 0;
    width: 240px;
    background: #333;
    color: white;
    font-family: var(--font-body);
    font-size: 12px;
    font-weight: 400 !important;
    padding: 10px 12px;
    border-radius: 6px;
    line-height: 1.4;
    text-align: left;
    z-index: 100;
    transition: opacity 0.2s, visibility 0.2s;
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
}

.table-tooltip-text::before {
    content: '';
    position: absolute;
    top: -6px;
    left: 12px;
    border-left: 6px solid transparent;
    border-right: 6px solid transparent;
    border-bottom: 6px solid #333;
}

.table-tooltip-icon:hover .table-tooltip-text {
    visibility: visible;
    opacity: 1;
}

/* Platform Table */
.platform-table {
    width: 100%;
    border-collapse: collapse;
    font-size: 13px;
}

.platform-table th {
    text-align: left;
    font-weight: 600;
    color: var(--color-text-secondary);
    font-size: 11px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    padding: 8px 12px;
    border-bottom: 1px solid var(--color-border);
}

.platform-table th:not(:first-child) {
    text-align: right;
}

.platform-table td {
    padding: 10px 12px;
    border-bottom: 1px solid #f0f0f0;
    vertical-align: middle;
}

.platform-table td:not(:first-child) {
    text-align: right;
}

.platform-table tbody tr:last-child td {
    border-bottom: none;
}

.platform-table tbody tr:nth-child(even) {
    background: #f8f9fa;
}

.platform-table tbody tr:hover {
    background: #f0f1f3;
}

/* Platform name with icon */
.platform-name {
    display: flex;
    align-items: center;
    gap: 8px;
}

.platform-icon {
    width: 20px;
    height: 20px;
    border-radius: 4px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 10px;
    font-weight: 700;
    color: white;
}

.platform-icon.chatgpt { background: #10a37f; }
.platform-icon.perplexity { background: #1a7f64; }
.platform-icon.gemini { background: #8e44ad; }
.platform-icon.copilot { background: #0078d4; }
.platform-icon.google-ai-mode { background: #4285f4; }
.platform-icon.google-ai-overview { background: #ea4335; }
.platform-icon.grok { background: #000000; }
.platform-icon.deepseek { background: #5865f2; }
.platform-icon.all-models { background: #333333; }

/* Bar visualization */
.bar-cell {
    display: flex;
    align-items: center;
    justify-content: flex-end;
    gap: 8px;
}

.bar-container {
    width: 60px;
    height: 8px;
    background: #f0f0f0;
    border-radius: 4px;
    overflow: hidden;
}

.bar-fill {
    height: 100%;
    background: var(--color-primary);
    border-radius: 4px;
}

.bar-value {
    font-weight: 600;
    min-width: 45px;
    text-align: right;
}

/* Numeric formatting */
.metric-value {
    font-weight: 600;
    color: var(--color-text-primary);
}

/* Tables grid layout */
.tables-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: var(--spacing-xl);
    margin-bottom: var(--spacing-2xl);
}
/* === sunburst-prompts.html === */
/* Sunburst Card */
.sunburst-card {
    background: var(--color-bg-card);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-xl);
    padding: var(--spacing-2xl);
}

.sunburst-card .card-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: var(--spacing-xl);
}

.sunburst-card .card-title {
    font-family: var(--font-display);
    font-size: 16px;
    font-weight: 700;
    color: #333;
    display: flex;
    align-items: center;
    gap: 8px;
}

.sunburst-card .tooltip-icon {
    position: relative;
    width: 18px;
    height: 18px;
    background: var(--color-accent-purple);
    border-radius: 50%;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    cursor: help;
    flex-shrink: 0;
}

.sunburst-card .tooltip-icon span {
    color: white;
    font-size: 12px;
    font-weight: 700;
    line-height: 1;
}

.sunburst-card .tooltip-text {
    visibility: hidden;
    opacity: 0;
    position: absolute;
    top: 28px;
    left: 0;
    width: 280px;
    background: #333;
    color: white;
    font-family: var(--font-body);
    font-size: 12px;
    font-weight: 400;
    padding: 10px 12px;
    border-radius: 6px;
    line-height: 1.4;
    z-index: 100;
    transition: opacity 0.2s;
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
}

.sunburst-card .tooltip-text::before {
    content: '';
    position: absolute;
    top: -6px;
    left: 12px;
    border-left: 6px solid transparent;
    border-right: 6px solid transparent;
    border-bottom: 6px solid #333;
}

.sunburst-card .tooltip-icon:hover .tooltip-text {
    visibility: visible;
    opacity: 1;
}

/* Sunburst layout */
.sunburst-container {
    display: flex;
    gap: 40px;
    align-items: flex-start;
}

.sunburst-chart {
    flex: 1;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
}

.sunburst-details {
    flex: 1;
    min-width: 300px;
}

.sunburst-details .details-header {
    font-family: var(--font-display);
    font-size: 14px;
    color: var(--color-text-secondary);
    text-transform: uppercase;
    letter-spacing: 0.5px;
    margin-bottom: 12px;
    padding-bottom: 8px;
    border-bottom: 2px solid var(--color-primary);
}

.sunburst-details .selected-category {
    font-family: var(--font-display);
    font-size: 20px;
    color: var(--color-primary);
    margin-bottom: 8px;
}

.sunburst-details .selected-count {
    font-size: 14px;
    color: var(--color-text-secondary);
    margin-bottom: 16px;
}

.sunburst-details .breadcrumb {
    font-size: 12px;
    color: var(--color-text-secondary);
    margin-bottom: 16px;
    display: flex;
    align-items: center;
    gap: 6px;
    flex-wrap: wrap;
}

.sunburst-details .breadcrumb-item {
    cursor: pointer;
    padding: 2px 8px;
    background: #f0f0f0;
    border-radius: 4px;
    transition: background 0.2s;
}

.sunburst-details .breadcrumb-item:hover {
    background: #e0e0e0;
}

.sunburst-details .breadcrumb-separator {
    color: #ccc;
}

.sunburst-details .prompts-list {
    max-height: 400px;
    overflow-y: auto;
}

.sunburst-details .prompt-item {
    padding: 10px 12px;
    background: #f8f9fa;
    border-radius: 6px;
    margin-bottom: 8px;
    font-size: 13px;
    color: var(--color-text-primary);
    border-left: 3px solid var(--color-primary);
}

.sunburst-details .prompt-item:hover {
    background: #f0f1f3;
}

/* Legend */
.sunburst-card .legend {
    display: flex;
    flex-wrap: wrap;
    gap: 16px;
    margin-top: 16px;
    justify-content: center;
}

.sunburst-card .legend-item {
    display: flex;
    align-items: center;
    gap: 6px;
    font-size: 12px;
    color: var(--color-text-secondary);
    cursor: pointer;
    transition: opacity 0.2s;
}

.sunburst-card .legend-item:hover {
    opacity: 0.7;
}

.sunburst-card .legend-color {
    width: 12px;
    height: 12px;
    border-radius: 3px;
}

/* Subcategory chips */
.subcategory-chips {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
    margin-bottom: 16px;
}

.subcategory-chip {
    display: flex;
    align-items: center;
    gap: 6px;
    padding: 4px 10px;
    background: #f0f0f0;
    border-radius: 16px;
    font-size: 12px;
    cursor: pointer;
    transition: all 0.2s;
}

.subcategory-chip:hover {
    background: var(--color-primary);
    color: white;
}

.subcategory-chip .chip-count {
    background: rgba(0,0,0,0.1);
    padding: 2px 6px;
    border-radius: 10px;
    font-size: 11px;
}

.subcategory-chip:hover .chip-count {
    background: rgba(255,255,255,0.2);
}

/* Center label */
.center-label {
    font-family: var(--font-display);
    text-anchor: middle;
    pointer-events: none;
}

.center-total {
    font-size: 28px;
    fill: var(--color-primary);
}

.center-text {
    font-size: 12px;
    fill: var(--color-text-secondary);
}

/* Arc hover effect */
.arc {
    cursor: pointer;
    transition: opacity 0.2s;
}

.arc:hover {
    opacity: 0.8;
}
/* === kpi-cards-dual.html === */
.kpi-row-dual {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: var(--spacing-lg);
    margin-bottom: var(--spacing-2xl);
}

/* Dual Metric KPI Card */
.kpi-card-dual {
    background: var(--color-bg-card);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-xl);
    padding: var(--spacing-xl);
    min-height: 180px;
    display: flex;
    flex-direction: column;
    position: relative;
}

.kpi-card-dual .kpi-tooltip {
    position: absolute;
    top: 12px;
    right: 12px;
    width: 18px;
    height: 18px;
    background: var(--color-accent-purple);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: help;
}

.kpi-card-dual .kpi-tooltip span {
    color: white;
    font-size: 12px;
    font-weight: 700;
    line-height: 1;
}

.kpi-card-dual .kpi-tooltip-text {
    visibility: hidden;
    opacity: 0;
    position: absolute;
    top: 28px;
    right: 0;
    width: 220px;
    background: #333;
    color: white;
    font-family: var(--font-body);
    font-size: 12px;
    font-weight: 400;
    padding: 10px 12px;
    border-radius: 6px;
    line-height: 1.4;
    text-align: left;
    z-index: 100;
    transition: opacity 0.2s, visibility 0.2s;
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
}

.kpi-card-dual .kpi-tooltip-text::before {
    content: '';
    position: absolute;
    top: -6px;
    right: 12px;
    border-left: 6px solid transparent;
    border-right: 6px solid transparent;
    border-bottom: 6px solid #333;
}

.kpi-card-dual .kpi-tooltip:hover .kpi-tooltip-text {
    visibility: visible;
    opacity: 1;
}

.kpi-card-dual .kpi-label {
    font-family: var(--font-display);
    font-size: var(--font-size-xs);
    text-transform: uppercase;
    color: var(--color-text-secondary);
    letter-spacing: 0.5px;
    font-weight: 700;
    text-align: center;
    margin-bottom: var(--spacing-md);
}

.kpi-dual-metrics {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: var(--spacing-lg);
    flex: 1;
}

.kpi-dual-item {
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
}

.kpi-dual-item-label {
    font-family: var(--font-display);
    font-size: var(--font-size-xs);
    text-transform: uppercase;
    letter-spacing: 0.5px;
    font-weight: 700;
    margin-bottom: var(--spacing-xs);
}

.kpi-dual-item.with .kpi-dual-item-label {
    color: var(--color-accent-green);
}

.kpi-dual-item.without .kpi-dual-item-label {
    color: var(--color-accent-red);
}

.kpi-dual-item-value {
    font-family: var(--font-display);
    font-size: var(--font-size-metric);
    font-weight: var(--font-weight-bold);
    line-height: var(--line-height-tight);
}

.kpi-dual-item.with .kpi-dual-item-value {
    color: var(--color-accent-green);
}

.kpi-dual-item.without .kpi-dual-item-value {
    color: var(--color-accent-red);
}

.kpi-dual-item-change {
    font-size: 13px;
    font-weight: 600;
    margin-top: var(--spacing-xs);
}

.kpi-dual-item.with .kpi-dual-item-change {
    color: var(--color-accent-green);
}

.kpi-dual-item.without .kpi-dual-item-change {
    color: var(--color-accent-red);
}

.kpi-dual-divider {
    width: 1px;
    height: 50px;
    background: var(--color-border);
}

/* Donut Chart KPI Card */
.kpi-card-donut {
    background: var(--color-bg-card);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-xl);
    padding: var(--spacing-xl);
    min-height: 180px;
    display: flex;
    flex-direction: column;
    position: relative;
}

.kpi-card-donut .kpi-tooltip {
    position: absolute;
    top: 12px;
    right: 12px;
    width: 18px;
    height: 18px;
    background: var(--color-accent-purple);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: help;
}

.kpi-card-donut .kpi-tooltip span {
    color: white;
    font-size: 12px;
    font-weight: 700;
    line-height: 1;
}

.kpi-card-donut .kpi-tooltip-text {
    visibility: hidden;
    opacity: 0;
    position: absolute;
    top: 28px;
    right: 0;
    width: 220px;
    background: #333;
    color: white;
    font-family: var(--font-body);
    font-size: 12px;
    font-weight: 400;
    padding: 10px 12px;
    border-radius: 6px;
    line-height: 1.4;
    text-align: left;
    z-index: 100;
    transition: opacity 0.2s, visibility 0.2s;
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
}

.kpi-card-donut .kpi-tooltip-text::before {
    content: '';
    position: absolute;
    top: -6px;
    right: 12px;
    border-left: 6px solid transparent;
    border-right: 6px solid transparent;
    border-bottom: 6px solid #333;
}

.kpi-card-donut .kpi-tooltip:hover .kpi-tooltip-text {
    visibility: visible;
    opacity: 1;
}

.kpi-card-donut .kpi-label {
    font-family: var(--font-display);
    font-size: var(--font-size-xs);
    text-transform: uppercase;
    color: var(--color-text-secondary);
    letter-spacing: 0.5px;
    font-weight: 700;
    text-align: center;
    margin-bottom: var(--spacing-sm);
}

.kpi-donut-content {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: var(--spacing-lg);
    flex: 1;
}

.kpi-donut-chart {
    position: relative;
    width: 100px;
    height: 100px;
}

.kpi-donut-chart svg {
    transform: rotate(-90deg);
    overflow: visible;
}

.kpi-donut-chart svg circle {
    cursor: pointer;
    transition: transform 0.2s ease, filter 0.2s ease;
    transform-origin: 50px 50px;
}

.kpi-donut-chart svg circle:hover {
    transform: scale(1.08);
    filter: brightness(1.1) drop-shadow(0 2px 4px rgba(0,0,0,0.2));
}

.kpi-donut-center {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    text-align: center;
}

.kpi-donut-total {
    font-family: var(--font-display);
    font-size: var(--font-size-lg);
    font-weight: var(--font-weight-bold);
    color: var(--color-primary);
    line-height: 1;
}

.kpi-donut-total-label {
    font-size: 9px;
    color: var(--color-text-secondary);
    text-transform: uppercase;
}

.kpi-donut-legend {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-xs);
}

.kpi-donut-legend-item {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    font-size: 12px;
}

.kpi-donut-legend-color {
    width: 10px;
    height: 10px;
    border-radius: 2px;
}

.kpi-donut-legend-color.pos1 { background: var(--color-accent-green); }
.kpi-donut-legend-color.pos2 { background: var(--color-accent-blue); }
.kpi-donut-legend-color.pos3 { background: var(--color-accent-yellow); }
.kpi-donut-legend-color.pos4 { background: var(--color-accent-red); }

.kpi-donut-legend-value {
    font-weight: 700;
    min-width: 24px;
}

.kpi-donut-legend-label {
    color: var(--color-text-secondary);
}
/* === prompt-rankings-table.html === */
/* Prompt Rankings Table Card */
.prompt-rankings-card {
    background: var(--color-bg-card);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-xl);
    overflow: hidden;
}

.prompt-rankings-card .card-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: var(--spacing-xl) var(--spacing-2xl);
    border-bottom: 1px solid var(--color-border);
}

.prompt-rankings-card .card-title {
    font-family: var(--font-display);
    font-size: 16px;
    font-weight: 700;
    color: #333;
    display: flex;
    align-items: center;
    gap: 8px;
}

.prompt-rankings-card .tooltip-icon {
    position: relative;
    width: 18px;
    height: 18px;
    background: var(--color-accent-purple);
    border-radius: 50%;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    cursor: help;
    flex-shrink: 0;
}

.prompt-rankings-card .tooltip-icon span {
    color: white;
    font-size: 12px;
    font-weight: 700;
    line-height: 1;
}

.prompt-rankings-card .tooltip-text {
    visibility: hidden;
    opacity: 0;
    position: absolute;
    top: 28px;
    left: 0;
    width: 280px;
    background: #333;
    color: white;
    font-family: var(--font-body);
    font-size: 12px;
    font-weight: 400;
    padding: 10px 12px;
    border-radius: 6px;
    line-height: 1.4;
    z-index: 100;
    transition: opacity 0.2s;
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
}

.prompt-rankings-card .tooltip-text::before {
    content: '';
    position: absolute;
    top: -6px;
    left: 12px;
    border-left: 6px solid transparent;
    border-right: 6px solid transparent;
    border-bottom: 6px solid #333;
}

.prompt-rankings-card .tooltip-icon:hover .tooltip-text {
    visibility: visible;
    opacity: 1;
}

.prompt-rankings-card .export-btn {
    display: flex;
    align-items: center;
    gap: 6px;
    padding: 8px 16px;
    background: white;
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    font-family: var(--font-body);
    font-size: 13px;
    color: var(--color-text-primary);
    cursor: pointer;
    transition: all 0.2s;
}

.prompt-rankings-card .export-btn:hover {
    border-color: var(--color-primary);
    color: var(--color-primary);
}

/* Table */
.prompt-rankings-card .table-wrapper {
    overflow-x: auto;
    max-height: 600px;
    overflow-y: auto;
}

.prompt-rankings-card .table-wrapper thead {
    position: sticky;
    top: 0;
    z-index: 10;
}

.rankings-table {
    width: 100%;
    border-collapse: collapse;
    font-size: 13px;
}

.rankings-table th {
    background: #f9fafb;
    padding: 12px 16px;
    text-align: left;
    font-size: 11px;
    font-weight: 600;
    color: var(--color-text-secondary);
    text-transform: uppercase;
    letter-spacing: 0.5px;
    border-bottom: 1px solid var(--color-border);
    white-space: nowrap;
}

.rankings-table th.sortable {
    cursor: pointer;
    user-select: none;
}

.rankings-table th.sortable:hover {
    color: var(--color-primary);
}

.rankings-table th .sort-icon {
    margin-left: 4px;
    opacity: 0.4;
}

.rankings-table td {
    padding: 14px 16px;
    border-bottom: 1px solid var(--color-border);
    vertical-align: middle;
}

.rankings-table tbody tr:hover {
    background: #f9fafb;
}

/* Column group headers */
.rankings-table .col-group-header {
    text-align: center !important;
    background: #f3f4f6 !important;
    border-left: 2px solid var(--color-border);
}

.rankings-table .col-subheader {
    font-size: 10px !important;
    font-weight: 500 !important;
    text-transform: none !important;
    letter-spacing: 0 !important;
}

.rankings-table .border-left {
    border-left: 2px solid var(--color-border);
}

/* Prompt column */
.rankings-table .prompt-link {
    color: var(--color-primary);
    text-decoration: none;
    font-weight: 500;
    display: block;
    max-width: 260px;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}

.rankings-table .prompt-link:hover {
    text-decoration: underline;
}

/* Model icon */
.rankings-table .model-icon {
    width: 26px;
    height: 26px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 11px;
    font-weight: 700;
    color: white;
}

.rankings-table .model-icon.chatgpt { background: #10a37f; }
.rankings-table .model-icon.gemini { background: #4285f4; }
.rankings-table .model-icon.perplexity { background: #1a1a2e; }
.rankings-table .model-icon.ai-overview { background: #ea4335; }

/* Topic */
.rankings-table .topic-text {
    max-width: 160px;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    color: var(--color-text-secondary);
}

/* Volume */
.rankings-table .volume-value {
    font-weight: 600;
    color: var(--color-text-primary);
}

/* Visibility bar */
.rankings-table .visibility-cell {
    min-width: 110px;
}

.rankings-table .visibility-bar {
    display: flex;
    align-items: center;
    gap: 10px;
}

.rankings-table .visibility-bar-bg {
    flex: 1;
    height: 8px;
    background: #e5e7eb;
    border-radius: 4px;
    overflow: hidden;
}

.rankings-table .visibility-bar-fill {
    height: 100%;
    background: var(--color-primary);
    border-radius: 4px;
    transition: width 0.3s;
}

.rankings-table .visibility-value {
    font-size: 12px;
    font-weight: 600;
    min-width: 38px;
    text-align: right;
}

/* Position values */
.rankings-table .position-value {
    font-weight: 600;
    text-align: center;
    display: block;
}

.rankings-table .position-value.top-3 { color: var(--color-positive); }
.rankings-table .position-value.mid { color: var(--color-warning); }
.rankings-table .position-value.low { color: var(--color-text-secondary); }

.rankings-table .position-na {
    color: var(--color-text-muted);
    text-align: center;
    display: block;
}

/* Position change */
.rankings-table .position-change {
    display: inline-flex;
    align-items: center;
    gap: 3px;
    padding: 3px 8px;
    border-radius: 4px;
    font-size: 12px;
    font-weight: 600;
}

.rankings-table .position-change.up {
    color: var(--color-positive);
    background: rgba(16, 185, 129, 0.1);
}

.rankings-table .position-change.down {
    color: var(--color-negative);
    background: rgba(239, 68, 68, 0.1);
}

.rankings-table .position-change.neutral {
    color: var(--color-text-muted);
    background: #f3f4f6;
}

.rankings-table .position-change.new {
    color: var(--color-primary);
    background: rgba(20, 40, 160, 0.1);
}

.rankings-table .position-change.lost {
    color: var(--color-negative);
    background: rgba(239, 68, 68, 0.1);
}

/* Product names */
.rankings-table .product-name {
    font-size: 12px;
    max-width: 140px;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    display: block;
}

.rankings-table .product-samsung {
    color: var(--color-primary);
    font-weight: 600;
}

.rankings-table .product-competitor {
    color: var(--color-text-secondary);
}

.rankings-table .product-na {
    color: var(--color-text-muted);
}
    </style>
</head>
<body>
<!-- === header.html === -->
<header>
    <div class="header-content">
        <span class="header-title">Samsung HE AI Visibility and Performance Dashboard</span>
        <img class="header-logo" src="./images/logo.jpg" alt="Samsung">
    </div>
</header>
<!-- === kpi-cards.html === -->
<div class="container">
    <div class="kpi-row">
        <div class="kpi-card">
            <div class="kpi-tooltip">
                <span>?</span>
                <div class="kpi-tooltip-text">Estimated share of audience likely to notice your brand in AI search results, based on prompt popularity and ranking position.</div>
            </div>
            <img class="kpi-icon" src="./images/sov.jpg" alt="Share of Voice">
            <div class="kpi-label">Share of Voice</div>
            <div class="kpi-value">65%</div>
            <div class="kpi-change increase">↑ +5%</div>
        </div>
        <div class="kpi-card">
            <div class="kpi-tooltip">
                <span>?</span>
                <div class="kpi-tooltip-text">Percentage of AI responses that cite your website as a source.</div>
            </div>
            <img class="kpi-icon" src="./images/source_visi.jpg" alt="Source Visibility">
            <div class="kpi-label">Source Visibility</div>
            <div class="kpi-value">42%</div>
            <div class="kpi-change increase">↑ +8%</div>
        </div>
        <div class="kpi-card">
            <div class="kpi-tooltip">
                <span>?</span>
                <div class="kpi-tooltip-text">Total visits to your website from AI platforms.</div>
            </div>
            <img class="kpi-icon" src="./images/referral.jpg" alt="Referral Traffic">
            <div class="kpi-label">Referral Traffic</div>
            <div class="kpi-value">106,445</div>
            <div class="kpi-change increase">↑ +10,989 (+10.3%)</div>
        </div>
        <div class="kpi-card">
            <div class="kpi-tooltip">
                <span>?</span>
                <div class="kpi-tooltip-text">Overall visibility score measuring your brand's presence across AI platforms.</div>
            </div>
            <img class="kpi-icon" src="./images/ai-visi.jpg" alt="AI Visibility">
            <div class="kpi-label">AI Visibility</div>
            <div class="kpi-value">91</div>
            <div class="kpi-change increase">↑ +12</div>
        </div>
    </div>
</div>
<!-- === line-charts.html === -->
<div class="container">
    <!-- ROW 1: Share of Voice + Source Visibility -->
    <div class="charts-row">
        <!-- CHART 1: Share of Voice -->
        <div class="chart-card">
            <div class="chart-header">
                <div class="chart-title">
                    Share of Voice
                    <div class="chart-tooltip-icon">
                        <span>?</span>
                        <div class="chart-tooltip-text">Estimated share of audience likely to notice your brand in AI search results, based on prompt popularity and ranking position.</div>
                    </div>
                </div>
                <button class="download-btn" title="Download">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                        <polyline points="7 10 12 15 17 10"/>
                        <line x1="12" y1="15" x2="12" y2="3"/>
                    </svg>
                </button>
            </div>
            <div class="chart-content">
                <div class="chart-area">
                    <svg id="chart-sov"></svg>
                </div>
                <div class="chart-insights">
                    <div class="insight-item">
                        <div class="insight-label">Leader</div>
                        <div class="insight-value">Samsung</div>
                        <div class="insight-change">65% share</div>
                    </div>
                    <div class="insight-item">
                        <div class="insight-label">Trend</div>
                        <div class="insight-value positive">↑ +3%</div>
                        <div class="insight-change">vs last period</div>
                    </div>
                    <div class="insight-item">
                        <div class="insight-label">Gap to #2</div>
                        <div class="insight-value">37pts</div>
                        <div class="insight-change">ahead of LG</div>
                    </div>
                </div>
            </div>
            <div class="chart-legend">
                <div class="legend-item"><span class="legend-dot" style="background: #1428A0"></span>Samsung</div>
                <div class="legend-item"><span class="legend-dot" style="background: #A50034"></span>LG</div>
                <div class="legend-item"><span class="legend-dot" style="background: #000000"></span>Sony</div>
                <div class="legend-item"><span class="legend-dot" style="background: #E31937"></span>TCL</div>
                <div class="legend-item"><span class="legend-dot" style="background: #00A0DF"></span>Hisense</div>
            </div>
        </div>

        <!-- CHART 2: Source Visibility -->
        <div class="chart-card">
            <div class="chart-header">
                <div class="chart-title">
                    Source Visibility
                    <div class="chart-tooltip-icon">
                        <span>?</span>
                        <div class="chart-tooltip-text">Percentage of AI responses that cite your website as a source.</div>
                    </div>
                </div>
                <button class="download-btn" title="Download">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                        <polyline points="7 10 12 15 17 10"/>
                        <line x1="12" y1="15" x2="12" y2="3"/>
                    </svg>
                </button>
            </div>
            <div class="chart-content">
                <div class="chart-area">
                    <svg id="chart-source"></svg>
                </div>
                <div class="chart-insights">
                    <div class="insight-item">
                        <div class="insight-label">Top Source</div>
                        <div class="insight-value">Samsung</div>
                        <div class="insight-change">42% cited</div>
                    </div>
                    <div class="insight-item">
                        <div class="insight-label">Growth</div>
                        <div class="insight-value positive">↑ +4%</div>
                        <div class="insight-change">this month</div>
                    </div>
                    <div class="insight-item">
                        <div class="insight-label">Citations</div>
                        <div class="insight-value">1,847</div>
                        <div class="insight-change">total mentions</div>
                    </div>
                </div>
            </div>
            <div class="chart-legend">
                <div class="legend-item"><span class="legend-dot" style="background: #1428A0"></span>Samsung</div>
                <div class="legend-item"><span class="legend-dot" style="background: #A50034"></span>LG</div>
                <div class="legend-item"><span class="legend-dot" style="background: #000000"></span>Sony</div>
                <div class="legend-item"><span class="legend-dot" style="background: #E31937"></span>TCL</div>
                <div class="legend-item"><span class="legend-dot" style="background: #00A0DF"></span>Hisense</div>
            </div>
        </div>
    </div>

    <!-- ROW 2: Referral Traffic + AI Visibility -->
    <div class="charts-row">
        <!-- CHART 3: Referral Traffic -->
        <div class="chart-card">
            <div class="chart-header">
                <div class="chart-title">
                    Referral Traffic
                    <div class="chart-tooltip-icon">
                        <span>?</span>
                        <div class="chart-tooltip-text">Total visits to your website from AI platforms.</div>
                    </div>
                </div>
                <button class="download-btn" title="Download">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                        <polyline points="7 10 12 15 17 10"/>
                        <line x1="12" y1="15" x2="12" y2="3"/>
                    </svg>
                </button>
            </div>
            <div class="chart-content">
                <div class="chart-area">
                    <svg id="chart-traffic"></svg>
                </div>
                <div class="chart-insights">
                    <div class="insight-item">
                        <div class="insight-label">Total Visits</div>
                        <div class="insight-value">106,445</div>
                        <div class="insight-change">from AI platforms</div>
                    </div>
                    <div class="insight-item">
                        <div class="insight-label">Change</div>
                        <div class="insight-value positive">↑ +10,989</div>
                        <div class="insight-change">+10.3% growth</div>
                    </div>
                    <div class="insight-item">
                        <div class="insight-label">Top Platform</div>
                        <div class="insight-value">ChatGPT</div>
                        <div class="insight-change">65,054 visits</div>
                    </div>
                </div>
            </div>
            <div class="chart-legend">
                <div class="legend-item"><span class="legend-dot" style="background: #1428A0"></span>Samsung</div>
                <div class="legend-item"><span class="legend-dot" style="background: #A50034"></span>LG</div>
                <div class="legend-item"><span class="legend-dot" style="background: #000000"></span>Sony</div>
                <div class="legend-item"><span class="legend-dot" style="background: #E31937"></span>TCL</div>
                <div class="legend-item"><span class="legend-dot" style="background: #00A0DF"></span>Hisense</div>
            </div>
        </div>

        <!-- CHART 4: AI Visibility -->
        <div class="chart-card">
            <div class="chart-header">
                <div class="chart-title">
                    AI Visibility
                    <div class="chart-tooltip-icon">
                        <span>?</span>
                        <div class="chart-tooltip-text">Overall visibility score measuring your brand's presence across AI platforms.</div>
                    </div>
                </div>
                <button class="download-btn" title="Download">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                        <polyline points="7 10 12 15 17 10"/>
                        <line x1="12" y1="15" x2="12" y2="3"/>
                    </svg>
                </button>
            </div>
            <div class="chart-content">
                <div class="chart-area">
                    <svg id="chart-visibility"></svg>
                </div>
                <div class="chart-insights">
                    <div class="insight-item">
                        <div class="insight-label">Score</div>
                        <div class="insight-value">91</div>
                        <div class="insight-change">out of 100</div>
                    </div>
                    <div class="insight-item">
                        <div class="insight-label">Rank</div>
                        <div class="insight-value">#1</div>
                        <div class="insight-change">in TV category</div>
                    </div>
                    <div class="insight-item">
                        <div class="insight-label">Momentum</div>
                        <div class="insight-value positive">↑ +6</div>
                        <div class="insight-change">points gained</div>
                    </div>
                </div>
            </div>
            <div class="chart-legend">
                <div class="legend-item"><span class="legend-dot" style="background: #1428A0"></span>Samsung</div>
                <div class="legend-item"><span class="legend-dot" style="background: #A50034"></span>LG</div>
                <div class="legend-item"><span class="legend-dot" style="background: #000000"></span>Sony</div>
                <div class="legend-item"><span class="legend-dot" style="background: #E31937"></span>TCL</div>
                <div class="legend-item"><span class="legend-dot" style="background: #00A0DF"></span>Hisense</div>
            </div>
        </div>
    </div>

    <!-- Tooltip element for line charts -->
    <div class="line-chart-tooltip" id="line-chart-tooltip"></div>
</div>
<!-- === platform-tables.html === -->
<div class="container">
    <div class="tables-grid">
        <!-- TABLE 1: Prompt Tracking Rankings (Share of Voice) -->
        <div class="platform-table-card">
            <div class="table-header">
                <div class="table-title">
                    Prompt Tracking Rankings
                    <div class="table-tooltip-icon">
                        <span>?</span>
                        <div class="table-tooltip-text">Share of Voice breakdown by AI platform, showing mentions and average ranking position.</div>
                    </div>
                </div>
                <button class="download-btn" title="Download">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                        <polyline points="7 10 12 15 17 10"/>
                        <line x1="12" y1="15" x2="12" y2="3"/>
                    </svg>
                </button>
            </div>
            <table class="platform-table">
                <thead>
                    <tr>
                        <th>Model</th>
                        <th>Share of Voice</th>
                        <th>Mentions</th>
                        <th>Avg. Position</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>
                            <div class="platform-name">
                                <div class="platform-icon google-ai-mode">G</div>
                                Google AI Mode
                            </div>
                        </td>
                        <td>
                            <div class="bar-cell">
                                <div class="bar-container"><div class="bar-fill" style="width: 72%"></div></div>
                                <span class="bar-value">72%</span>
                            </div>
                        </td>
                        <td>
                            <div class="bar-cell">
                                <div class="bar-container"><div class="bar-fill" style="width: 82%"></div></div>
                                <span class="bar-value">53</span>
                            </div>
                        </td>
                        <td class="metric-value">1.7</td>
                    </tr>
                    <tr>
                        <td>
                            <div class="platform-name">
                                <div class="platform-icon google-ai-overview">G</div>
                                Google AI Overview
                            </div>
                        </td>
                        <td>
                            <div class="bar-cell">
                                <div class="bar-container"><div class="bar-fill" style="width: 61%"></div></div>
                                <span class="bar-value">61%</span>
                            </div>
                        </td>
                        <td>
                            <div class="bar-cell">
                                <div class="bar-container"><div class="bar-fill" style="width: 66%"></div></div>
                                <span class="bar-value">43</span>
                            </div>
                        </td>
                        <td class="metric-value">2.1</td>
                    </tr>
                    <tr>
                        <td>
                            <div class="platform-name">
                                <div class="platform-icon chatgpt">C</div>
                                ChatGPT
                            </div>
                        </td>
                        <td>
                            <div class="bar-cell">
                                <div class="bar-container"><div class="bar-fill" style="width: 60%"></div></div>
                                <span class="bar-value">60%</span>
                            </div>
                        </td>
                        <td>
                            <div class="bar-cell">
                                <div class="bar-container"><div class="bar-fill" style="width: 100%"></div></div>
                                <span class="bar-value">65</span>
                            </div>
                        </td>
                        <td class="metric-value">2.3</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- TABLE 2: Prompt Tracking Citations (Source Visibility) -->
        <div class="platform-table-card">
            <div class="table-header">
                <div class="table-title">
                    Prompt Tracking Citations
                    <div class="table-tooltip-icon">
                        <span>?</span>
                        <div class="table-tooltip-text">Source Visibility breakdown by AI platform, showing citation counts and unique URLs cited.</div>
                    </div>
                </div>
                <button class="download-btn" title="Download">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                        <polyline points="7 10 12 15 17 10"/>
                        <line x1="12" y1="15" x2="12" y2="3"/>
                    </svg>
                </button>
            </div>
            <table class="platform-table">
                <thead>
                    <tr>
                        <th>Model</th>
                        <th>Source Visibility</th>
                        <th>Citations</th>
                        <th>Cited URLs</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>
                            <div class="platform-name">
                                <div class="platform-icon google-ai-overview">G</div>
                                Google AI Overview
                            </div>
                        </td>
                        <td>
                            <div class="bar-cell">
                                <div class="bar-container"><div class="bar-fill" style="width: 52%"></div></div>
                                <span class="bar-value">52%</span>
                            </div>
                        </td>
                        <td>
                            <div class="bar-cell">
                                <div class="bar-container"><div class="bar-fill" style="width: 100%"></div></div>
                                <span class="bar-value">2,555</span>
                            </div>
                        </td>
                        <td class="metric-value">129</td>
                    </tr>
                    <tr>
                        <td>
                            <div class="platform-name">
                                <div class="platform-icon chatgpt">C</div>
                                ChatGPT
                            </div>
                        </td>
                        <td>
                            <div class="bar-cell">
                                <div class="bar-container"><div class="bar-fill" style="width: 34%"></div></div>
                                <span class="bar-value">34%</span>
                            </div>
                        </td>
                        <td>
                            <div class="bar-cell">
                                <div class="bar-container"><div class="bar-fill" style="width: 50%"></div></div>
                                <span class="bar-value">1,287</span>
                            </div>
                        </td>
                        <td class="metric-value">288</td>
                    </tr>
                    <tr>
                        <td>
                            <div class="platform-name">
                                <div class="platform-icon google-ai-mode">G</div>
                                Google AI Mode
                            </div>
                        </td>
                        <td>
                            <div class="bar-cell">
                                <div class="bar-container"><div class="bar-fill" style="width: 45%"></div></div>
                                <span class="bar-value">45%</span>
                            </div>
                        </td>
                        <td>
                            <div class="bar-cell">
                                <div class="bar-container"><div class="bar-fill" style="width: 52%"></div></div>
                                <span class="bar-value">1,332</span>
                            </div>
                        </td>
                        <td class="metric-value">427</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- TABLE 3: Referral Traffic by Platform -->
        <div class="platform-table-card">
            <div class="table-header">
                <div class="table-title">
                    Referral Traffic
                    <div class="table-tooltip-icon">
                        <span>?</span>
                        <div class="table-tooltip-text">Website visits from each AI platform, ranked by total traffic volume.</div>
                    </div>
                </div>
                <button class="download-btn" title="Download">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                        <polyline points="7 10 12 15 17 10"/>
                        <line x1="12" y1="15" x2="12" y2="3"/>
                    </svg>
                </button>
            </div>
            <table class="platform-table">
                <thead>
                    <tr>
                        <th>Model</th>
                        <th>Total Visits</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>
                            <div class="platform-name">
                                <div class="platform-icon chatgpt">C</div>
                                ChatGPT
                            </div>
                        </td>
                        <td>
                            <div class="bar-cell">
                                <div class="bar-container"><div class="bar-fill" style="width: 100%"></div></div>
                                <span class="bar-value metric-value">65,054</span>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <div class="platform-name">
                                <div class="platform-icon perplexity">P</div>
                                Perplexity
                            </div>
                        </td>
                        <td>
                            <div class="bar-cell">
                                <div class="bar-container"><div class="bar-fill" style="width: 19%"></div></div>
                                <span class="bar-value metric-value">12,614</span>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <div class="platform-name">
                                <div class="platform-icon gemini">G</div>
                                Gemini
                            </div>
                        </td>
                        <td>
                            <div class="bar-cell">
                                <div class="bar-container"><div class="bar-fill" style="width: 19%"></div></div>
                                <span class="bar-value metric-value">12,492</span>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <div class="platform-name">
                                <div class="platform-icon copilot">C</div>
                                Copilot
                            </div>
                        </td>
                        <td>
                            <div class="bar-cell">
                                <div class="bar-container"><div class="bar-fill" style="width: 9%"></div></div>
                                <span class="bar-value metric-value">6,149</span>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <div class="platform-name">
                                <div class="platform-icon google-ai-mode">G</div>
                                Google AI Mode
                            </div>
                        </td>
                        <td>
                            <div class="bar-cell">
                                <div class="bar-container"><div class="bar-fill" style="width: 7%"></div></div>
                                <span class="bar-value metric-value">4,739</span>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <div class="platform-name">
                                <div class="platform-icon grok">X</div>
                                Grok
                            </div>
                        </td>
                        <td>
                            <div class="bar-cell">
                                <div class="bar-container"><div class="bar-fill" style="width: 6%"></div></div>
                                <span class="bar-value metric-value">3,894</span>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <div class="platform-name">
                                <div class="platform-icon deepseek">D</div>
                                Deepseek
                            </div>
                        </td>
                        <td>
                            <div class="bar-cell">
                                <div class="bar-container"><div class="bar-fill" style="width: 0.2%"></div></div>
                                <span class="bar-value metric-value">143</span>
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- TABLE 4: AI Visibility by Platform -->
        <div class="platform-table-card">
            <div class="table-header">
                <div class="table-title">
                    AI Visibility
                    <div class="table-tooltip-icon">
                        <span>?</span>
                        <div class="table-tooltip-text">Brand visibility metrics by AI platform, including mentions, audience reach, and pages cited.</div>
                    </div>
                </div>
                <button class="download-btn" title="Download">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                        <polyline points="7 10 12 15 17 10"/>
                        <line x1="12" y1="15" x2="12" y2="3"/>
                    </svg>
                </button>
            </div>
            <table class="platform-table">
                <thead>
                    <tr>
                        <th>Model</th>
                        <th>Mentions</th>
                        <th>Audience</th>
                        <th>Cited Pages</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>
                            <div class="platform-name">
                                <div class="platform-icon all-models">*</div>
                                All Models
                            </div>
                        </td>
                        <td>
                            <div class="bar-cell">
                                <div class="bar-container"><div class="bar-fill" style="width: 100%"></div></div>
                                <span class="bar-value">336,070</span>
                            </div>
                        </td>
                        <td>
                            <div class="bar-cell">
                                <div class="bar-container"><div class="bar-fill" style="width: 100%"></div></div>
                                <span class="bar-value">1.02B</span>
                            </div>
                        </td>
                        <td class="metric-value">86,918</td>
                    </tr>
                    <tr>
                        <td>
                            <div class="platform-name">
                                <div class="platform-icon google-ai-overview">G</div>
                                AI Overview
                            </div>
                        </td>
                        <td>
                            <div class="bar-cell">
                                <div class="bar-container"><div class="bar-fill" style="width: 38%"></div></div>
                                <span class="bar-value">127,293</span>
                            </div>
                        </td>
                        <td>
                            <div class="bar-cell">
                                <div class="bar-container"><div class="bar-fill" style="width: 86%"></div></div>
                                <span class="bar-value">880.6M</span>
                            </div>
                        </td>
                        <td class="metric-value">58,296</td>
                    </tr>
                    <tr>
                        <td>
                            <div class="platform-name">
                                <div class="platform-icon chatgpt">C</div>
                                ChatGPT
                            </div>
                        </td>
                        <td>
                            <div class="bar-cell">
                                <div class="bar-container"><div class="bar-fill" style="width: 24%"></div></div>
                                <span class="bar-value">79,785</span>
                            </div>
                        </td>
                        <td>
                            <div class="bar-cell">
                                <div class="bar-container"><div class="bar-fill" style="width: 7%"></div></div>
                                <span class="bar-value">73.0M</span>
                            </div>
                        </td>
                        <td class="metric-value">33,383</td>
                    </tr>
                    <tr>
                        <td>
                            <div class="platform-name">
                                <div class="platform-icon gemini">G</div>
                                Gemini
                            </div>
                        </td>
                        <td>
                            <div class="bar-cell">
                                <div class="bar-container"><div class="bar-fill" style="width: 22%"></div></div>
                                <span class="bar-value">74,689</span>
                            </div>
                        </td>
                        <td>
                            <div class="bar-cell">
                                <div class="bar-container"><div class="bar-fill" style="width: 2%"></div></div>
                                <span class="bar-value">16.1M</span>
                            </div>
                        </td>
                        <td class="metric-value">6,693</td>
                    </tr>
                    <tr>
                        <td>
                            <div class="platform-name">
                                <div class="platform-icon google-ai-mode">G</div>
                                AI Mode
                            </div>
                        </td>
                        <td>
                            <div class="bar-cell">
                                <div class="bar-container"><div class="bar-fill" style="width: 18%"></div></div>
                                <span class="bar-value">60,879</span>
                            </div>
                        </td>
                        <td>
                            <div class="bar-cell">
                                <div class="bar-container"><div class="bar-fill" style="width: 5%"></div></div>
                                <span class="bar-value">54.1M</span>
                            </div>
                        </td>
                        <td class="metric-value">24,638</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>
<!-- === sunburst-prompts.html === -->
<div class="container">
    <div class="sunburst-card">
    <div class="card-header">
        <div class="card-title">
            Prompt Categories
            <div class="tooltip-icon">
                <span>?</span>
                <div class="tooltip-text">Interactive visualization of prompt categories. Click on segments to drill down into subcategories and view related prompts.</div>
            </div>
        </div>
    </div>

    <div class="sunburst-container">
        <div class="sunburst-chart">
            <div id="sunburst"></div>
            <div class="legend" id="legend"></div>
        </div>
        <div class="sunburst-details">
            <div class="details-header">Selected Category</div>
            <div class="breadcrumb" id="breadcrumb"></div>
            <div class="selected-category" id="selected-name">All Categories</div>
            <div class="selected-count" id="selected-count">382 prompts</div>
            <div class="subcategory-chips" id="subcategories"></div>
            <div class="details-header" style="margin-top: 20px;">Sample Prompts</div>
            <div class="prompts-list" id="prompts-list"></div>
        </div>
    </div>
    </div>
</div>
<!-- === kpi-cards-dual.html === -->
<div class="container">
    <div class="kpi-row-dual">
        <!-- Dual Metric Card: Prompt Mentions -->
        <div class="kpi-card-dual">
            <div class="kpi-tooltip">
                <span>?</span>
                <div class="kpi-tooltip-text">Prompts where your brand is mentioned vs. not mentioned in AI responses.</div>
            </div>
            <div class="kpi-label">Prompt Mentions</div>
            <div class="kpi-dual-metrics">
                <div class="kpi-dual-item with">
                    <div class="kpi-dual-item-label">With</div>
                    <div class="kpi-dual-item-value">847</div>
                    <div class="kpi-dual-item-change">↑ +52</div>
                </div>
                <div class="kpi-dual-divider"></div>
                <div class="kpi-dual-item without">
                    <div class="kpi-dual-item-label">Without</div>
                    <div class="kpi-dual-item-value">153</div>
                    <div class="kpi-dual-item-change">↓ -18</div>
                </div>
            </div>
        </div>

        <!-- Dual Metric Card: Top Product Position -->
        <div class="kpi-card-dual">
            <div class="kpi-tooltip">
                <span>?</span>
                <div class="kpi-tooltip-text">Number of products that improved (win) or declined (lose) in ranking position.</div>
            </div>
            <div class="kpi-label">Top Product Position</div>
            <div class="kpi-dual-metrics">
                <div class="kpi-dual-item with">
                    <div class="kpi-dual-item-label">Win</div>
                    <div class="kpi-dual-item-value">24</div>
                    <div class="kpi-dual-item-change">↑ +8</div>
                </div>
                <div class="kpi-dual-divider"></div>
                <div class="kpi-dual-item without">
                    <div class="kpi-dual-item-label">Lose</div>
                    <div class="kpi-dual-item-value">12</div>
                    <div class="kpi-dual-item-change">↓ -3</div>
                </div>
            </div>
        </div>

        <!-- Dual Metric Card: Products Win/Lose -->
        <div class="kpi-card-dual">
            <div class="kpi-tooltip">
                <span>?</span>
                <div class="kpi-tooltip-text">Products gaining vs. losing visibility in AI responses compared to last period.</div>
            </div>
            <div class="kpi-label">Products Win/Lose</div>
            <div class="kpi-dual-metrics">
                <div class="kpi-dual-item with">
                    <div class="kpi-dual-item-label">Gaining</div>
                    <div class="kpi-dual-item-value">38</div>
                    <div class="kpi-dual-item-change">↑ +12</div>
                </div>
                <div class="kpi-dual-divider"></div>
                <div class="kpi-dual-item without">
                    <div class="kpi-dual-item-label">Losing</div>
                    <div class="kpi-dual-item-value">9</div>
                    <div class="kpi-dual-item-change">↓ -5</div>
                </div>
            </div>
        </div>

        <!-- Donut Chart Card: Position Distribution -->
        <div class="kpi-card-donut">
            <div class="kpi-tooltip">
                <span>?</span>
                <div class="kpi-tooltip-text">Distribution of products by ranking position in AI responses.</div>
            </div>
            <div class="kpi-label">Position Distribution</div>
            <div class="kpi-donut-content">
                <div class="kpi-donut-chart">
                    <svg width="100" height="100" viewBox="0 0 100 100">
                        <!-- Pos 1: 35% (green) -->
                        <circle cx="50" cy="50" r="40" fill="none" stroke="#10b981" stroke-width="18"
                            stroke-dasharray="87.96 251.33" stroke-dashoffset="0"/>
                        <!-- Pos 2: 28% (blue) -->
                        <circle cx="50" cy="50" r="40" fill="none" stroke="#3b82f6" stroke-width="18"
                            stroke-dasharray="70.37 251.33" stroke-dashoffset="-87.96"/>
                        <!-- Pos 3: 22% (yellow) -->
                        <circle cx="50" cy="50" r="40" fill="none" stroke="#f59e0b" stroke-width="18"
                            stroke-dasharray="55.29 251.33" stroke-dashoffset="-158.33"/>
                        <!-- Pos 4+: 15% (red) -->
                        <circle cx="50" cy="50" r="40" fill="none" stroke="#ef4444" stroke-width="18"
                            stroke-dasharray="37.70 251.33" stroke-dashoffset="-213.62"/>
                    </svg>
                    <div class="kpi-donut-center">
                        <div class="kpi-donut-total">108</div>
                        <div class="kpi-donut-total-label">Total</div>
                    </div>
                </div>
                <div class="kpi-donut-legend">
                    <div class="kpi-donut-legend-item">
                        <div class="kpi-donut-legend-color pos1"></div>
                        <span class="kpi-donut-legend-value">38</span>
                        <span class="kpi-donut-legend-label">Pos 1</span>
                    </div>
                    <div class="kpi-donut-legend-item">
                        <div class="kpi-donut-legend-color pos2"></div>
                        <span class="kpi-donut-legend-value">30</span>
                        <span class="kpi-donut-legend-label">Pos 2</span>
                    </div>
                    <div class="kpi-donut-legend-item">
                        <div class="kpi-donut-legend-color pos3"></div>
                        <span class="kpi-donut-legend-value">24</span>
                        <span class="kpi-donut-legend-label">Pos 3</span>
                    </div>
                    <div class="kpi-donut-legend-item">
                        <div class="kpi-donut-legend-color pos4"></div>
                        <span class="kpi-donut-legend-value">16</span>
                        <span class="kpi-donut-legend-label">Pos 4+</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- === prompt-rankings-table.html === -->
<div class="container">
    <div class="prompt-rankings-card">
    <div class="card-header">
        <div class="card-title">
            Prompt Rankings (Top Products)
            <div class="tooltip-icon">
                <span>?</span>
                <div class="tooltip-text">Shows prompt performance over time including visibility, position rankings, and top products mentioned. Samsung products are highlighted in blue.</div>
            </div>
        </div>
        <button class="export-btn">
            <span>↓</span> Export
        </button>
    </div>

    <div class="table-wrapper">
        <table class="rankings-table">
            <thead>
                <tr>
                    <th class="sortable">Prompt <span class="sort-icon">↕</span></th>
                    <th>Model</th>
                    <th class="sortable">Topic <span class="sort-icon">↕</span></th>
                    <th class="sortable">Topic Vol. <span class="sort-icon">↕</span></th>
                    <th class="sortable">Visibility <span class="sort-icon">↕</span></th>
                    <th class="col-group-header" colspan="2">Position</th>
                    <th>Change</th>
                    <th class="col-group-header" colspan="2">Product</th>
                </tr>
                <tr>
                    <th></th>
                    <th></th>
                    <th></th>
                    <th></th>
                    <th></th>
                    <th class="col-subheader border-left">Dec 10, 2023</th>
                    <th class="col-subheader">Jan 8, 2025</th>
                    <th></th>
                    <th class="col-subheader border-left">Dec 10, 2023</th>
                    <th class="col-subheader">Jan 8, 2025</th>
                </tr>
            </thead>
            <tbody id="rankings-body">
                <!-- Populated by JavaScript -->
            </tbody>
        </table>
    </div>
    </div>
</div>
<script>
// === line-charts.html ===
// Chart configuration
const chartConfig = {
    width: 540,
    height: 300,
    margin: { top: 20, right: 20, bottom: 40, left: 55 }
};

// Color palette - brand colors
const colors = {
    samsung: '#1428A0',
    lg: '#A50034',
    sony: '#000000',
    tcl: '#E31937',
    hisense: '#00A0DF',
    grid: '#e8e8e8',
    axis: '#999'
};

// Tooltip element
const lineChartTooltip = d3.select('#line-chart-tooltip');

/**
 * Create a line chart
 */
function createLineChart(selector, data, options = {}) {
    const { width, height, margin } = chartConfig;
    const innerWidth = width - margin.left - margin.right;
    const innerHeight = height - margin.top - margin.bottom;

    const svg = d3.select(selector)
        .attr('viewBox', `0 0 ${width} ${height}`)
        .attr('preserveAspectRatio', 'none');

    const g = svg.append('g')
        .attr('transform', `translate(${margin.left},${margin.top})`);

    // Scales
    const x = d3.scalePoint()
        .domain(data.dates)
        .range([0, innerWidth])
        .padding(0.1);

    const yMax = options.yMax || d3.max(data.series.flatMap(s => s.values)) * 1.1;
    const y = d3.scaleLinear()
        .domain([0, yMax])
        .range([innerHeight, 0])
        .nice();

    // Grid lines (horizontal)
    const gridLines = y.ticks(5);
    g.selectAll('.grid-line')
        .data(gridLines)
        .join('line')
        .attr('class', 'grid-line')
        .attr('x1', 0)
        .attr('x2', innerWidth)
        .attr('y1', d => y(d))
        .attr('y2', d => y(d));

    // Line generator
    const line = d3.line()
        .x((d, i) => x(data.dates[i]))
        .y(d => y(d))
        .curve(d3.curveMonotoneX);

    // Draw lines
    data.series.forEach((series, seriesIndex) => {
        // Line path
        g.append('path')
            .datum(series.values)
            .attr('class', 'data-line')
            .attr('stroke', series.color)
            .attr('d', line);

        // Data points
        g.selectAll(`.point-${seriesIndex}`)
            .data(series.values)
            .join('circle')
            .attr('class', `data-point point-${seriesIndex}`)
            .attr('cx', (d, i) => x(data.dates[i]))
            .attr('cy', d => y(d))
            .attr('r', 4)
            .attr('fill', series.color)
            .on('mouseenter', function(event, d) {
                const i = series.values.indexOf(d);
                const formatted = options.format ? options.format(d) : d;
                lineChartTooltip.html(`<strong>${series.name}</strong><br>${data.dates[i]}: ${formatted}`)
                    .classed('visible', true)
                    .style('left', (event.pageX + 10) + 'px')
                    .style('top', (event.pageY - 10) + 'px');
                d3.select(this).attr('r', 6);
            })
            .on('mouseleave', function() {
                lineChartTooltip.classed('visible', false);
                d3.select(this).attr('r', 4);
            });
    });

    // X Axis
    const xAxis = g.append('g')
        .attr('class', 'axis x-axis')
        .attr('transform', `translate(0,${innerHeight})`)
        .call(d3.axisBottom(x).tickSize(0).tickPadding(12));

    xAxis.select('.domain').attr('stroke', colors.axis);
    xAxis.selectAll('text')
        .style('font-size', '14px')
        .style('font-family', "'Samsung One', sans-serif");

    // Y Axis
    const yAxis = g.append('g')
        .attr('class', 'axis y-axis')
        .call(d3.axisLeft(y)
            .ticks(5)
            .tickSize(0)
            .tickPadding(12)
            .tickFormat(options.yFormat || (d => d)));

    yAxis.select('.domain').remove();
    yAxis.selectAll('text')
        .style('font-size', '14px')
        .style('font-family', "'Samsung One', sans-serif");
}

// ========== CHART 1: Share of Voice ==========
createLineChart('#chart-sov', {
    dates: ['Dec 14', 'Dec 21', 'Dec 28', 'Jan 4'],
    series: [
        { name: 'Samsung', color: colors.samsung, values: [62, 64, 63, 65] },
        { name: 'LG', color: colors.lg, values: [28, 27, 29, 28] },
        { name: 'Sony', color: colors.sony, values: [22, 23, 22, 24] },
        { name: 'TCL', color: colors.tcl, values: [18, 19, 20, 19] },
        { name: 'Hisense', color: colors.hisense, values: [15, 16, 15, 17] }
    ]
}, {
    yMax: 80,
    yFormat: d => d + '%',
    format: d => d + '%'
});

// ========== CHART 2: Source Visibility ==========
createLineChart('#chart-source', {
    dates: ['Dec 14', 'Dec 21', 'Dec 28', 'Jan 4'],
    series: [
        { name: 'Samsung', color: colors.samsung, values: [38, 40, 41, 42] },
        { name: 'LG', color: colors.lg, values: [22, 21, 23, 22] },
        { name: 'Sony', color: colors.sony, values: [18, 19, 18, 20] },
        { name: 'TCL', color: colors.tcl, values: [12, 13, 14, 13] },
        { name: 'Hisense', color: colors.hisense, values: [8, 9, 10, 11] }
    ]
}, {
    yMax: 60,
    yFormat: d => d + '%',
    format: d => d + '%'
});

// ========== CHART 3: Referral Traffic ==========
createLineChart('#chart-traffic', {
    dates: ['Dec 14', 'Dec 21', 'Dec 28', 'Jan 4'],
    series: [
        { name: 'Samsung', color: colors.samsung, values: [95456, 98200, 102000, 106445] },
        { name: 'LG', color: colors.lg, values: [48000, 50000, 51500, 53000] },
        { name: 'Sony', color: colors.sony, values: [40000, 41500, 43000, 44000] },
        { name: 'TCL', color: colors.tcl, values: [28000, 29500, 31000, 32000] },
        { name: 'Hisense', color: colors.hisense, values: [22000, 23500, 25000, 26000] }
    ]
}, {
    yFormat: d => d >= 1000 ? (d/1000) + 'k' : d,
    format: d => d.toLocaleString()
});

// ========== CHART 4: AI Visibility ==========
createLineChart('#chart-visibility', {
    dates: ['Dec 14', 'Dec 21', 'Dec 28', 'Jan 4'],
    series: [
        { name: 'Samsung', color: colors.samsung, values: [85, 87, 89, 91] },
        { name: 'LG', color: colors.lg, values: [72, 73, 74, 75] },
        { name: 'Sony', color: colors.sony, values: [68, 69, 70, 71] },
        { name: 'TCL', color: colors.tcl, values: [55, 57, 58, 60] },
        { name: 'Hisense', color: colors.hisense, values: [48, 50, 52, 55] }
    ]
}, {
    yMax: 100,
    yFormat: d => d,
    format: d => d
});

// === sunburst-prompts.html ===
// Sunburst data - replace with actual data
const sunburstData = {
    "meta": { "totalPrompts": 382, "totalTags": 58 },
    "tagTree": {
        "TV Features": {
            "children": {
                "AI": { "children": {}, "count": 6 },
                "Anti-Glare": { "children": {}, "count": 26 },
                "Art Mode": { "children": {}, "count": 5 },
                "Brightness": { "children": {}, "count": 11 },
                "Connectivity": { "children": {}, "count": 5 },
                "HDR": { "children": {}, "count": 6 },
                "Input Lag": { "children": {}, "count": 7 },
                "Motion Handling": { "children": {}, "count": 16 },
                "Panel Technology": { "children": {}, "count": 8 },
                "Picture Settings": { "children": {}, "count": 18 },
                "Refresh Rate": { "children": {}, "count": 12 },
                "Resolution": { "children": { "4K": { "children": {}, "count": 11 }, "8K": { "children": {}, "count": 1 } }, "count": 31 },
                "Smart Features": { "children": {}, "count": 3 },
                "Sound": { "children": {}, "count": 1 },
                "Streaming": { "children": {}, "count": 1 },
                "Viewing Angles": { "children": {}, "count": 3 }
            },
            "count": 301
        },
        "TV Models": {
            "children": {
                "Art TV": { "children": {}, "count": 1 },
                "Gaming TVs": { "children": {}, "count": 40 },
                "Micro RGB": { "children": {}, "count": 16 },
                "Mini-LED": { "children": {}, "count": 22 },
                "Movies & Cinema": { "children": {}, "count": 11 },
                "OLED": { "children": {}, "count": 26 },
                "Outdoor TV": { "children": {}, "count": 2 },
                "QLED": { "children": {}, "count": 31 },
                "Smart TV": { "children": {}, "count": 7 },
                "Sports TVs": { "children": {}, "count": 33 }
            },
            "count": 347
        },
        "TV Reviews & Brand": {
            "children": {
                "Affordable": { "children": {}, "count": 5 },
                "Best Of": { "children": {}, "count": 85 },
                "Brand": { "children": {}, "count": 109 },
                "Brand TV Model Reviews": { "children": {}, "count": 37 },
                "Buying Guides": { "children": {}, "count": 57 },
                "Comparison": { "children": {}, "count": 38 },
                "Deals": { "children": {}, "count": 4 },
                "Year Reviews": { "children": { "2025": { "children": {}, "count": 10 }, "2026": { "children": {}, "count": 33 } }, "count": 84 }
            },
            "count": 621
        },
        "TV Sizes": {
            "children": {
                "Large Size": { "children": {}, "count": 28 },
                "Medium Size": { "children": {}, "count": 16 },
                "Small Size": { "children": {}, "count": 6 },
                "Super Size": { "children": {}, "count": 3 },
                "Viewing Distance": { "children": {}, "count": 10 }
            },
            "count": 130
        }
    },
    "prompts": [
        { "text": "best 75 inch tv for sports", "tags": ["TV Reviews & Brand", "TV Reviews & Brand__Best Of", "TV Sizes", "TV Sizes__Large Size", "TV Models", "TV Models__Sports TVs"] },
        { "text": "4K AI upscaling tv", "tags": ["TV Features", "TV Features__AI", "TV Features__Resolution", "TV Features__Resolution__4K"] },
        { "text": "best gaming tv 2026", "tags": ["TV Models", "TV Models__Gaming TVs", "TV Reviews & Brand", "TV Reviews & Brand__Best Of", "TV Reviews & Brand__Year Reviews", "TV Reviews & Brand__Year Reviews__2026"] },
        { "text": "OLED vs QLED for movies", "tags": ["TV Models", "TV Models__OLED", "TV Models__QLED", "TV Models__Movies & Cinema", "TV Reviews & Brand", "TV Reviews & Brand__Comparison"] },
        { "text": "best anti-glare tv 2026", "tags": ["TV Features", "TV Features__Anti-Glare", "TV Reviews & Brand", "TV Reviews & Brand__Best Of", "TV Reviews & Brand__Year Reviews", "TV Reviews & Brand__Year Reviews__2026"] }
    ]
};

// Sunburst initialization
(function() {
    const data = sunburstData;
    const width = 550;
    const height = 550;
    const radius = Math.min(width, height) / 2;

    const colorPalette = {
        'TV Features': '#1428A0',
        'TV Models': '#4285f4',
        'TV Reviews & Brand': '#10a37f',
        'TV Sizes': '#8e44ad'
    };

    function convertToHierarchy(tagTree) {
        const root = { name: 'All Categories', children: [] };
        for (const [category, data] of Object.entries(tagTree)) {
            const categoryNode = { name: category, count: data.count, children: [] };
            if (data.children && Object.keys(data.children).length > 0) {
                for (const [subcat, subdata] of Object.entries(data.children)) {
                    const subcatNode = { name: subcat, count: subdata.count, parent: category, children: [] };
                    if (subdata.children && Object.keys(subdata.children).length > 0) {
                        for (const [subsubcat, subsubdata] of Object.entries(subdata.children)) {
                            subcatNode.children.push({ name: subsubcat, count: subsubdata.count, value: subsubdata.count });
                        }
                    }
                    if (subcatNode.children.length === 0) subcatNode.value = subdata.count;
                    categoryNode.children.push(subcatNode);
                }
            }
            if (categoryNode.children.length === 0) categoryNode.value = data.count;
            root.children.push(categoryNode);
        }
        return root;
    }

    const hierarchyData = convertToHierarchy(data.tagTree);
    const partition = d3.partition().size([2 * Math.PI, radius]);
    const root = d3.hierarchy(hierarchyData).sum(d => d.value || 0).sort((a, b) => b.value - a.value);
    partition(root);

    const arc = d3.arc()
        .startAngle(d => d.x0)
        .endAngle(d => d.x1)
        .innerRadius(d => d.y0 * 0.8)
        .outerRadius(d => d.y1 * 0.8 - 1)
        .padAngle(0.01)
        .padRadius(radius / 2);

    const svg = d3.select('#sunburst')
        .append('svg')
        .attr('width', width)
        .attr('height', height)
        .append('g')
        .attr('transform', `translate(${width / 2}, ${height / 2})`);

    function getColor(d) {
        if (d.depth === 0) return '#fff';
        let node = d;
        while (node.depth > 1) node = node.parent;
        const baseColor = colorPalette[node.data.name] || '#666';
        if (d.depth === 1) return baseColor;
        if (d.depth === 2) return d3.color(baseColor).brighter(0.5).toString();
        return d3.color(baseColor).brighter(1).toString();
    }

    const paths = svg.selectAll('path')
        .data(root.descendants().filter(d => d.depth > 0))
        .enter()
        .append('path')
        .attr('class', 'arc')
        .attr('d', arc)
        .attr('fill', d => getColor(d))
        .attr('stroke', '#fff')
        .attr('stroke-width', 2)
        .on('click', (event, d) => selectCategory(d));

    svg.append('circle')
        .attr('r', radius * 0.35)
        .attr('fill', '#fff')
        .attr('stroke', '#e0e0e0')
        .attr('stroke-width', 2)
        .style('cursor', 'pointer')
        .on('click', () => selectCategory(root));

    svg.append('text').attr('class', 'center-label center-total').attr('dy', '-0.2em').text(data.meta.totalPrompts);
    svg.append('text').attr('class', 'center-label center-text').attr('dy', '1.2em').text('prompts');

    const legend = d3.select('#legend');
    for (const [name, color] of Object.entries(colorPalette)) {
        const item = legend.append('div').attr('class', 'legend-item').on('click', () => {
            const node = root.descendants().find(d => d.data.name === name);
            if (node) selectCategory(node);
        });
        item.append('div').attr('class', 'legend-color').style('background', color);
        item.append('span').text(name);
    }

    function selectCategory(d) {
        document.getElementById('selected-name').textContent = d.data.name;
        document.getElementById('selected-count').textContent = `${d.value} prompts`;

        const breadcrumb = document.getElementById('breadcrumb');
        breadcrumb.innerHTML = '';
        d.ancestors().reverse().forEach((node, i) => {
            if (i > 0) {
                const sep = document.createElement('span');
                sep.className = 'breadcrumb-separator';
                sep.textContent = '›';
                breadcrumb.appendChild(sep);
            }
            const item = document.createElement('span');
            item.className = 'breadcrumb-item';
            item.textContent = node.data.name;
            item.onclick = () => selectCategory(node);
            breadcrumb.appendChild(item);
        });

        const subcatsDiv = document.getElementById('subcategories');
        subcatsDiv.innerHTML = '';
        if (d.children) {
            d.children.forEach(child => {
                const chip = document.createElement('div');
                chip.className = 'subcategory-chip';
                chip.innerHTML = `${child.data.name} <span class="chip-count">${child.value}</span>`;
                chip.onclick = () => selectCategory(child);
                subcatsDiv.appendChild(chip);
            });
        }

        const promptsList = document.getElementById('prompts-list');
        promptsList.innerHTML = '';
        const name = d.data.name;
        let tagFilter = () => true;
        if (d.depth === 1) tagFilter = (p) => p.tags.some(t => t === name || t.startsWith(name + '__'));
        else if (d.depth === 2) tagFilter = (p) => p.tags.some(t => t === `${d.parent.data.name}__${name}` || t.startsWith(`${d.parent.data.name}__${name}__`));

        data.prompts.filter(tagFilter).slice(0, 15).forEach(prompt => {
            const item = document.createElement('div');
            item.className = 'prompt-item';
            item.textContent = prompt.text;
            promptsList.appendChild(item);
        });

        paths.attr('opacity', node => {
            if (d.depth === 0) return 1;
            let current = node;
            while (current) { if (current === d) return 1; current = current.parent; }
            current = d;
            while (current) { if (current === node) return 1; current = current.parent; }
            return 0.3;
        });

        // Filter the prompt rankings table if available
        if (typeof window.renderRankingsTable === 'function') {
            window.renderRankingsTable(d.data.name);
        }
    }

    selectCategory(root);
})();

// === prompt-rankings-table.html ===
// Sample prompt rankings data with categories for filtering
const promptRankingsData = [
    { prompt: "what tv should I buy?", model: "chatgpt", topic: "TV Purchase and Specification", topicVolume: 5324, visibility: 89, positionPrev: null, positionCurr: 3, change: "new", productPrev: null, productCurr: { name: "OLED S90F 4K TV", isSamsung: true }, categories: ["TV Reviews & Brand", "Buying Guides"] },
    { prompt: "What are the best OLED TVs available right now?", model: "chatgpt", topic: "OLED TV Comparison", topicVolume: 4890, visibility: 94, positionPrev: 3, positionCurr: 3, change: "up", changeValue: 1, productPrev: { name: "OLED 4K S95F TV", isSamsung: true }, productCurr: { name: "OLED 4K S90F TV", isSamsung: true }, categories: ["TV Models", "OLED", "TV Reviews & Brand", "Best Of"] },
    { prompt: "What are the most reliable OLED TVs for movie lovers?", model: "chatgpt", topic: "OLED TV Comparison", topicVolume: 4890, visibility: 92, positionPrev: 1, positionCurr: 4, change: "down", changeValue: 3, productPrev: { name: "OLED 4K S95F TV", isSamsung: true }, productCurr: { name: "OLED 4K S90F TV", isSamsung: true }, categories: ["TV Models", "OLED", "Movies & Cinema"] },
    { prompt: "Which TVs offer both OLED and 4K resolution?", model: "gemini", topic: "OLED TV Models Comparison", topicVolume: 4820, visibility: 85, positionPrev: 4, positionCurr: 4, change: "neutral", productPrev: { name: "S95F OLED", isSamsung: true }, productCurr: { name: "OLED 4K S90F TV", isSamsung: true }, categories: ["TV Models", "OLED", "TV Features", "Resolution"] },
    { prompt: "Which TVs are best for bright rooms: OLED or mini LED?", model: "chatgpt", topic: "QD Mini-LED TVs", topicVolume: 4354, visibility: 81, positionPrev: 9, positionCurr: 7, change: "up", changeValue: 2, productPrev: { name: "S95F OLED TV", isSamsung: true }, productCurr: { name: "Neo OLED", isSamsung: true }, categories: ["TV Models", "Mini-LED", "OLED", "TV Features", "Brightness"] },
    { prompt: "What are the best reviewed mini LED TVs?", model: "perplexity", topic: "RGB LED and Mini-LED TVs", topicVolume: 4210, visibility: 78, positionPrev: null, positionCurr: 8, change: "new", productPrev: null, productCurr: { name: "Neo OLED Mini-LED TV", isSamsung: true }, categories: ["TV Models", "Mini-LED", "TV Reviews & Brand", "Best Of"] },
    { prompt: "What are the main differences between OLED and mini LED TVs?", model: "ai-overview", topic: "RGB LED and Mini-LED TVs", topicVolume: 4210, visibility: 71, positionPrev: 1, positionCurr: null, change: "lost", productPrev: { name: "LG OLED C3", isSamsung: false }, productCurr: null, categories: ["TV Models", "Mini-LED", "OLED", "TV Reviews & Brand", "Comparison"] },
    { prompt: "What are the most recommended gaming TVs for new consoles?", model: "chatgpt", topic: "Elite TVs and HD TVs", topicVolume: 3794, visibility: 88, positionPrev: 3, positionCurr: 6, change: "down", changeValue: 3, productPrev: { name: "S95F QD-OLED", isSamsung: true }, productCurr: { name: "Neo OLED QN70F 144Hz TV", isSamsung: true }, categories: ["TV Models", "Gaming TVs", "TV Reviews & Brand", "Best Of"] },
    { prompt: "Which gaming TVs are best for PS5 or Xbox Series X?", model: "gemini", topic: "4K TVs with FreeSync", topicVolume: 3738, visibility: 82, positionPrev: 1, positionCurr: 2, change: "down", changeValue: 1, productPrev: { name: "S90F OLED 4K TV", isSamsung: true }, productCurr: { name: "OLED 4K S90F TV", isSamsung: true }, categories: ["TV Models", "Gaming TVs", "TV Features", "Refresh Rate"] },
    { prompt: "What are the differences between mini LED and micro RGB TVs?", model: "chatgpt", topic: "LG Micro LED and Large TV", topicVolume: 3067, visibility: 68, positionPrev: 3, positionCurr: 1, change: "up", changeValue: 2, productPrev: null, productCurr: { name: "Micro RGB", isSamsung: true }, categories: ["TV Models", "Mini-LED", "Micro RGB", "TV Reviews & Brand", "Comparison"] },
    { prompt: "Best 75 inch TV for sports watching", model: "chatgpt", topic: "Sports TVs", topicVolume: 3521, visibility: 86, positionPrev: 2, positionCurr: 2, change: "neutral", productPrev: { name: "QN90B Neo QLED", isSamsung: true }, productCurr: { name: "QN90C Neo QLED", isSamsung: true }, categories: ["TV Models", "Sports TVs", "TV Sizes", "Large Size"] },
    { prompt: "Best QLED TV 2026", model: "chatgpt", topic: "QLED Reviews", topicVolume: 4102, visibility: 91, positionPrev: 1, positionCurr: 1, change: "neutral", productPrev: { name: "Samsung Q80B", isSamsung: true }, productCurr: { name: "Samsung Q80C", isSamsung: true }, categories: ["TV Models", "QLED", "TV Reviews & Brand", "Best Of", "Year Reviews"] },
    { prompt: "Is QLED better than OLED for bright rooms?", model: "gemini", topic: "QLED vs OLED", topicVolume: 3845, visibility: 79, positionPrev: 5, positionCurr: 3, change: "up", changeValue: 2, productPrev: { name: "Samsung QN85B", isSamsung: true }, productCurr: { name: "Samsung QN85C", isSamsung: true }, categories: ["TV Models", "QLED", "OLED", "TV Features", "Brightness", "TV Reviews & Brand", "Comparison"] },
    { prompt: "Best TV for HDR gaming", model: "perplexity", topic: "HDR Gaming TVs", topicVolume: 2987, visibility: 74, positionPrev: 6, positionCurr: 4, change: "up", changeValue: 2, productPrev: { name: "LG C2 OLED", isSamsung: false }, productCurr: { name: "Samsung S95C", isSamsung: true }, categories: ["TV Models", "Gaming TVs", "TV Features", "HDR"] },
    { prompt: "55 inch vs 65 inch TV for living room", model: "ai-overview", topic: "TV Size Guide", topicVolume: 4521, visibility: 83, positionPrev: 2, positionCurr: 2, change: "neutral", productPrev: { name: "Samsung QN65Q80B", isSamsung: true }, productCurr: { name: "Samsung QN65Q80C", isSamsung: true }, categories: ["TV Sizes", "Medium Size", "TV Reviews & Brand", "Buying Guides"] },
    { prompt: "Best anti-glare TV for sunny rooms", model: "chatgpt", topic: "Anti-Glare Technology", topicVolume: 2654, visibility: 77, positionPrev: 4, positionCurr: 3, change: "up", changeValue: 1, productPrev: { name: "Samsung S95B", isSamsung: true }, productCurr: { name: "Samsung S95C", isSamsung: true }, categories: ["TV Features", "Anti-Glare", "Brightness", "TV Reviews & Brand", "Best Of"] },
    { prompt: "120Hz vs 144Hz for gaming TV", model: "gemini", topic: "Refresh Rate Guide", topicVolume: 2341, visibility: 72, positionPrev: 7, positionCurr: 5, change: "up", changeValue: 2, productPrev: { name: "Samsung QN90B", isSamsung: true }, productCurr: { name: "Samsung QN90C", isSamsung: true }, categories: ["TV Features", "Refresh Rate", "TV Models", "Gaming TVs"] },
    { prompt: "Best 85 inch TV 2026", model: "chatgpt", topic: "Large TVs", topicVolume: 1987, visibility: 69, positionPrev: null, positionCurr: 6, change: "new", productPrev: null, productCurr: { name: "Samsung QN85QN90C", isSamsung: true }, categories: ["TV Sizes", "Large Size", "TV Reviews & Brand", "Best Of", "Year Reviews"] },
    { prompt: "Samsung The Frame TV reviews 2026", model: "perplexity", topic: "Samsung Brand Reviews", topicVolume: 3124, visibility: 85, positionPrev: 1, positionCurr: 1, change: "neutral", productPrev: { name: "The Frame 2024", isSamsung: true }, productCurr: { name: "The Frame 2025", isSamsung: true }, categories: ["TV Reviews & Brand", "Brand", "Brand TV Model Reviews"] },
    { prompt: "Best budget 4K TV under $500", model: "ai-overview", topic: "Budget TVs", topicVolume: 5102, visibility: 81, positionPrev: 3, positionCurr: 4, change: "down", changeValue: 1, productPrev: { name: "TCL 5-Series", isSamsung: false }, productCurr: { name: "Samsung CU7000", isSamsung: true }, categories: ["TV Reviews & Brand", "Affordable", "TV Features", "Resolution"] }
];

// Prompt Rankings Table initialization
(function() {
    const modelIcons = {
        chatgpt: '<div class="model-icon chatgpt" title="ChatGPT">G</div>',
        gemini: '<div class="model-icon gemini" title="Gemini">G</div>',
        perplexity: '<div class="model-icon perplexity" title="Perplexity">P</div>',
        "ai-overview": '<div class="model-icon ai-overview" title="AI Overview">A</div>'
    };

    function getPositionClass(pos) {
        if (pos === null) return '';
        if (pos <= 3) return 'top-3';
        if (pos <= 6) return 'mid';
        return 'low';
    }

    function formatPosition(pos) {
        if (pos === null) return '<span class="position-na">—</span>';
        return `<span class="position-value ${getPositionClass(pos)}">${pos}</span>`;
    }

    function formatChange(row) {
        if (row.change === 'new') return '<span class="position-change new">New</span>';
        if (row.change === 'lost') return '<span class="position-change lost">Lost</span>';
        if (row.change === 'neutral') return '<span class="position-change neutral">—</span>';
        if (row.change === 'up') return `<span class="position-change up">▲ ${row.changeValue}</span>`;
        if (row.change === 'down') return `<span class="position-change down">▼ ${row.changeValue}</span>`;
        return '';
    }

    function formatProduct(product) {
        if (!product) return '<span class="product-na">—</span>';
        const className = product.isSamsung ? 'product-samsung' : 'product-competitor';
        return `<span class="product-name ${className}" title="${product.name}">${product.name}</span>`;
    }

    // Global render function that can be called with filter
    window.renderRankingsTable = function(filter = null) {
        const tbody = document.getElementById('rankings-body');
        let filteredData = promptRankingsData;

        if (filter && filter !== 'All Categories') {
            filteredData = promptRankingsData.filter(row =>
                row.categories.some(cat => cat === filter || cat.includes(filter))
            );
        }

        tbody.innerHTML = filteredData.map(row => `
            <tr>
                <td><a href="#" class="prompt-link" title="${row.prompt}">${row.prompt}</a></td>
                <td>${modelIcons[row.model]}</td>
                <td><span class="topic-text" title="${row.topic}">${row.topic}</span></td>
                <td><span class="volume-value">${row.topicVolume.toLocaleString()}</span></td>
                <td class="visibility-cell">
                    <div class="visibility-bar">
                        <div class="visibility-bar-bg">
                            <div class="visibility-bar-fill" style="width: ${row.visibility}%"></div>
                        </div>
                        <span class="visibility-value">${row.visibility}%</span>
                    </div>
                </td>
                <td class="border-left">${formatPosition(row.positionPrev)}</td>
                <td>${formatPosition(row.positionCurr)}</td>
                <td>${formatChange(row)}</td>
                <td class="border-left">${formatProduct(row.productPrev)}</td>
                <td>${formatProduct(row.productCurr)}</td>
            </tr>
        `).join('');

        // Update count if element exists
        const countEl = document.querySelector('.prompt-rankings-card .filter-count');
        if (countEl) {
            countEl.textContent = `${filteredData.length} prompts`;
        }
    };

    // Initial render
    window.renderRankingsTable();
})();
</script>
</body>
</html>
